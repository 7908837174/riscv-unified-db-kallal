# yaml-language-server: $schema=../../schemas/csr_schema.json

scounteren:
  long_name: Supervisor Counter Enable
  address: 0x106
  priv_mode: M
  length: 32
  description: |
    Delegates control of the hardware performance-monitoring counters
    to U-mode
  definedBy: S # actually, defined by RV64, but must implement U-mode for this CSR to exist
  fields:
    CY:
      location: 0
      description: |
        When set, the `cycle` CSR (an alias of `mcycle`) is accessible to U-mode
        <% if ext?(:H) %>(delegation to VS/VU mode is further handled by `hcounteren.CY`)<% end %>.

        This bit is read-only 0 when `mcounteren.CY` is clear.

        Summary:

        !===
        ! `mcounteren.CY` ! `scounteren.CY` behavior

        ! 0 ! read-only 0
        ! 1 ! writeable
        !===
      type: RW
      reset_value: UNDEFINED_LEGAL
    TM:
      location: 1
      description: |
        When set, the `time` CSR (an alias of memory-mapped `mtime`) is accessible to U-mode
        <% if ext?(:H) %>(delegation to VS/VU mode is further handled by `hcounteren.TM`)<% end %>.

        This bit is read-only 0 when `mcounteren.TM` is clear.

        Summary:

        !===
        ! `mcounteren.TM` ! `scounteren.TM` behavior

        ! 0 ! read-only 0
        ! 1 ! writeable
        !===

      type: RW
      reset_value: UNDEFINED_LEGAL
    IR:
      location: 2
      description: |
        When set, the `instret` CSR (an alias of memory-mapped `minstret`) is accessible to U-mode
        <% if ext?(:H) %>(delegation to VS/VU mode is further handled by `hcounteren.IR`)<% end %>.

        This bit is read-only 0 when `mcounteren.IR` is clear.

        Summary:

        !===
        ! `mcounteren.IR` ! `scounteren.IR` behavior

        ! 0 ! read-only 0
        ! 1 ! writeable
        !===


      type: RW
      reset_value: UNDEFINED_LEGAL
    <%- NUM_HPM_COUNTERS.times do |hpm_num| -%>
    HPM<%= hpm_num + 3 %>:
      location: <%= 3 + hpm_num %>
      description: |
        When set, the `hpmcounter<%= 3 + hpm_num %>` CSR (an alias of `mhpmcounter<%= 3 + hpm_num %>`)
        is accessible to U-mode
        <% if ext?(:H) %>(delegation to VS/VU mode is further handled by `hcounteren.TM`)<% end %>.


        This bit is read-only 0 when `mcounteren.HPM<%= hpm_num + 3 %>` is clear.

        Summary:

        !===
        ! `mcounteren.HPM<%= hpm_num + 3 %>` ! `scounteren.HPM<%= hpm_num + 3 %>` behavior

        ! 0 ! read-only 0
        ! 1 ! writeable
        !===

      type: RW
      reset_value: UNDEFINED_LEGAL
    <%- end -%>
