# yaml-language-server: $schema=csr_schema.json

mcycle:
  long_name: Machine Cycle Counter
  definedBy: I
  address: 0xB00
  description: Cycle counter
  priv_mode: M
  length: 64
  fields:
    COUNT:
      alias:
        - cycle.COUNT
      location: 63-0
      type: RW-H
      description: |
        Cycle counter.

        <%- if ext?(:Zicntr) -%>
        Aliased as `cycle.CYCLE`.
        <%- end -%>

        Increments every cycle unless:

          * `mcountinhibit.CY` <%- if ext?(:Smcdeleg) -%>or its alias `scountinhibit.CY`<%- end -%> is set
          <%- if ext?(:Smcntrpmf) -%>
          * `mcyclecfg.MINH` is set and the current privilege level is M
          <%- if ext?(:S) -%>
          * `mcyclecfg.SINH` <%- if ext?(:Ssccfg) -%>or its alias `instretcfg.SINH`<%- end -%> is set and the current privilege level is (H)S
          <%- end -%>
          <%- if ext?(:U) -%>
          * `mcyclecfg.UINH` <%- if ext?(:Ssccfg) -%>or its alias `instretcfg.SINH`<%- end -%> is set and the current privilege level is U
          <%- end -%>
          <%- if ext?(:H) -%>
          * `mcyclecfg.VSINH` <%- if ext?(:Ssccfg) -%>or its alias `instretcfg.SINH`<%- end -%> is set and the current privilege level is VS
          * `mcyclecfg.VUINH` <%- if ext?(:Ssccfg) -%>or its alias `instretcfg.SINH`<%- end -%> is set and the current privilege level is VU
          <%- end -%>
          <%- end -%>
      reset_value: 0
      affectedBy: [Zicntr, Smcntrpmf, Smcdeleg, Ssccfg]
